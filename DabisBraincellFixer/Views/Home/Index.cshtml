@model DabisBraincellFixer.Models.Comm

@{
    ViewData["Title"] = "Home";
}

<h2>Trigger Event</h2>

<div>
    <label for="actionInput">Action:</label>
    <input id="actionInput" type="text" placeholder="Enter action..." />
    <button id="sendBtn">Send</button>
</div>

<div id="result" style="margin-top:1em;color:green;"></div>

@section Scripts {
    <script>
        document.getElementById('sendBtn').addEventListener('click', async () => {
            var actionValue = document.getElementById('actionInput').value;
            try {
                let resp = await fetch('http://localhost:8000/event', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ msg_msg: actionValue })
                });
                
                if (!resp.ok) throw new Error(resp.status + ' ' + resp.statusText);
                
                let text = await resp.text();
                document.getElementById('result').innerText = 'Success: ' + text;
            }
            catch (err) {
                document.getElementById('result').style.color = 'red';
                document.getElementById('result').innerText = 'Error: ' + err;
            }
        });
    </script>
}